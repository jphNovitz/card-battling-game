<!-- Try to make a  card battling game -->
<!-- using vanilla javascript          -->
<!-- @jphNovitz                        -->
<!-- hello@jiphi.be                    -->

<html>
    <head>
        <meta charset="UTF-8"> 
        <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" 
            rel="stylesheet" 
            integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" 
            crossorigin="anonymous">
        <title>card battling game @jphNovitz</title>
    </head>

    <body>
        <div class="container">
            <div class="row">
                    <div class="col-md-6">
                            <div id="player_1" class="col-md-12" style="border-bottom: dotted 1px #fff">
                            </div>
                            
                            <div id="player_2" class="col-md-12">
                            </div>

                            </div>
                <div class="col-md-6">
                    <div class="row">
                            <div class="lateral col-md-12">
                                <span id="points_1">
                                    0
                                </span>
                            </div>
                            <div class="col-md-12">
                                    <button id="test" class="btn btn-info btn-block">play</button>
                            </div>
                            <div class="lateral col-md-12">
                                    <span id="points_2">
                                            0
                                        </span>
                            </div>
                    </div>
                </div>

            </div>

        </div>

    </body>
    <script>
    /* variables definitions */
        var cards = []
        var family = ['clubs',  'spades', 'hearts', 'diamonds']
        var figures = ['2', '3', '4', '5', '6', '7', '8', '9', '10', 'Q', 'V', 'K', 'A']
        var player_1 = {
            cards: [],
            points: 0,
            encore: true
        };
        var player_2 = {
            cards: [],
            points: 0,
            encore: true
        };


    /* end variable definitions */

        initialize()
        distribute()
        document.getElementById('test').addEventListener("click", play)
       


    /****** functions ******/
   
        function initialize() {
            figures.map(function (fig) {
                for (let i = 0 ; i < 4 ; i++) {
                    let test = {
                        'family': family[i],
                        'figure': fig,
                        'value': figures.indexOf(fig)
                    }
                    cards.push(test)
                }
            })
        }

        /**
        *   distribute() give alternatively cards to player 1 an player 2 
        *   till cards array is empty
        **/
        function distribute() {
            while (cards.length > 0) {
                // card to player 1
                giveCardToPlayer(player_1) 
              /*  randomCard = cards[Math.floor(Math.random() * cards.length)]
                cardPosition = cards.indexOf(randomCard)
                player_1.cards.push(randomCard)
                cards.splice(cardPosition,1)
               */ 
               
               // card to player 2
               giveCardToPlayer(player_2) 
               /* randomCard = cards[Math.floor(Math.random() * cards.length)]
                cardPosition = cards.indexOf(randomCard)
                player_2.cards.push(randomCard)
                cards.splice(pos,1)
                */
            }   
        }

        /**
        *   giveCardToPLayer() take a card from cards and give it to player
        **/
        function giveCardToPlayer(player) {
            let randomCard = cards[Math.floor(Math.random() * cards.length)]
            let cardPosition = cards.indexOf(randomCard)
            player.cards.push(randomCard)
            cards.splice(cardPosition,1)

        }

        function play(){
            if (player_1.encore) {
                let card = player_1.cards[1]
                player_1.points += card.value
                    const visualCard = document.createElement('div')
                    visualCard.classList.add('card')
                    const cardContent = document.createTextNode(card.figure)
                    visualCard.appendChild(cardContent)
                    document.getElementById('player_1').appendChild(visualCard)
                    document.getElementById('points_1').innerHTML= player_1.points
                player_1.cards.splice(1,1)
                if (player_1.cards.length === 1) {
                    player_1.encore = false
                }
            }
                window.setTimeout(function () {
                if (player_2.encore) {
                    let card = player_2.cards[1]
                    player_2.points += card.value
                    const visualCard = document.createElement('div')
                    visualCard.classList.add('card')
                    const cardContent = document.createTextNode(card.figure)
                    visualCard.appendChild(cardContent)
                    document.getElementById('player_2').appendChild(visualCard)
                    document.getElementById('points_2').innerHTML= player_2.points
                    player_2.cards.splice(1,1)
                    player_2.cards.length
                    if (player_2.cards.length == 1) {
                        player_2.encore = false
                        document.getElementById('test').removeEventListener("click", alert('fini'))                        
                    } 
                }
            }, 1800)
            
        }

        
    </script>
</html>

<style>
    .container {
        background-color: rgb(1,130,118);
        height: 99vh;
    }

    #player_1, #player_2 {
        height: 49vh;
        min-height: 49vh;
        padding: 1.5em;
    }

    .lateral {
        height: 47vh;
        min-height: 45vh;

        display: flex;
        flex-direction: column;
        align-items: center;
    }

    #points_1, #points_2 {
        margin: auto;
        background-color: inherit;
        color: rgb(248,236,73);
        font-size: 2em;
    }

    .card {
        background-color: #fff;
        color: #000;
        border: solid 1px rgb(248,236,73) ;
        border-radius: 5px ;  
        margin-left: -15px ; 
        margin-top: 2px;
        width: 50px ; height: 70px ; 
        float: left ; 
    }
    
</style>